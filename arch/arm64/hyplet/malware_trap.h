#ifndef __MALWARE_TRAP_H__
#define __MALWARE_TRAP_H__

#if defined(__HYPLET_MALWARE_TRAP__)
	void stash_descriptor(unsigned long addr, unsigned long* pg ,int idx);
	void malware_init_procfs(void);
#else
	void stash_descriptor(unsigned long addr, unsigned long* pg ,int idx){}
	void malware_init_procfs(void){}
#endif


void malware_prep_mmio(char *addr);
void prepare_special_addresses(struct hyplet_vm *vm);
void dwc3_mmio_abrt_action10(struct hyplet_vm *, struct hyplet_driver_handler*);
void dwc3_mmio_abrt_actionb00(struct hyplet_vm *, struct hyplet_driver_handler*);

#if defined(RASPBERRY_PI3)
		#define EL2_FAULT_ADDRESS  0x3fd00000LL
	#else
		#define EL2_FAULT_ADDRESS 0x1a000000LL
#endif

#define MODULE_NAME "hyp_ops: "

static inline unsigned long el2_fault_address(void){
		return EL2_FAULT_ADDRESS;
}

#endif
